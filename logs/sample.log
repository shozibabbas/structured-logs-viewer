2026-01-30 04:31:32,967 | INFO | message_queue_listener | Received message on data.pipeline.input.document_processing
2026-01-30 04:31:32,968 | INFO | message_queue_listener | ACKing message early for job_id=955c43cd15634ecf978438dbdeb58cf7 to prevent timeout redelivery
2026-01-30 04:31:32,983 | INFO | data_ingestion.scripts.file_handler | Downloading file_url=https://storage.example.com/uploads/1769742167103-Sample_Document_March_28_2025.pdf original_filename=downloaded_file
2026-01-30 04:31:32,987 | INFO | data_ingestion.scripts.file_handler | Downloaded original_filename=downloaded_file -> temp_path=/tmp/ingest_nd5ccpe_.pdf size_bytes=1293253
2026-01-30 04:31:33,049 | INFO | data_processing.app.graph.ingest_graph | Document 8351626d-da95-4094-bdfe-89f5eb2ff64e routed to extract mode: pdf_scanned_vision
2026-01-30 04:31:33,308 | INFO | data_processing.app.graph.ingest_graph | Extracting text from 4 scanned pages of PDF 8351626d-da95-4094-bdfe-89f5eb2ff64e using vision OCR/VLM
2026-01-30 04:31:34,287 | INFO | data_processing.app.graph.ingest_graph | Extracted page 1 of document 8351626d-da95-4094-bdfe-89f5eb2ff64e, chars=1909
2026-01-30 04:31:34,794 | INFO | data_processing.app.graph.ingest_graph | Extracted page 2 of document 8351626d-da95-4094-bdfe-89f5eb2ff64e, chars=745
2026-01-30 04:31:35,560 | INFO | data_processing.app.graph.ingest_graph | Extracted page 3 of document 8351626d-da95-4094-bdfe-89f5eb2ff64e, chars=1423
2026-01-30 04:31:37,366 | INFO | data_processing.app.graph.ingest_graph | Extracted page 4 of document 8351626d-da95-4094-bdfe-89f5eb2ff64e, chars=2052
2026-01-30 04:31:37,366 | INFO | data_processing.app.graph.ingest_graph | Completed vision extraction for scanned PDF 8351626d-da95-4094-bdfe-89f5eb2ff64e, writing outputs
2026-01-30 04:31:37,370 | INFO | data_processing.app.graph.ingest_graph | Starting document classification step
2026-01-30 04:31:37,371 | INFO | data_processing.app.graph.ingest_graph | Embedding document snippet for classification
2026-01-30 04:31:37,422 | INFO | httpx | HTTP Request: POST http://10.0.1.100:11434/api/embed "HTTP/1.1 200 OK"
2026-01-30 04:31:37,423 | INFO | data_processing.app.graph.ingest_graph | Embedding complete, querying checklist items
2026-01-30 04:31:37,430 | INFO | httpx | HTTP Request: POST http://10.0.1.101:6333/collections/checklist_embeddings/points/query "HTTP/1.1 200 OK"
2026-01-30 04:31:37,435 | INFO | data_processing.app.graph.ingest_graph | Invoking LLM for document classification
2026-01-30 04:31:49,515 | INFO | httpx | HTTP Request: POST http://10.0.1.100:11434/api/chat "HTTP/1.1 200 OK"
2026-01-30 04:31:49,515 | INFO | data_processing.app.graph.ingest_graph | LLM chose category: Other (conf=0.85)
2026-01-30 04:31:49,516 | INFO | data_processing.app.graph.ingest_graph | Invoking LLM for requirement matching in category 'Other'
2026-01-30 04:31:50,418 | INFO | httpx | HTTP Request: POST http://10.0.1.100:11434/api/chat "HTTP/1.1 200 OK"
2026-01-30 04:31:50,418 | INFO | data_processing.app.graph.ingest_graph | LLM matched 0 requirements in category 'Other'
2026-01-30 04:31:50,418 | INFO | data_processing.app.graph.ingest_graph | Recording classification result
2026-01-30 04:31:50,420 | INFO | data_processing.app.graph.ingest_graph | Classification complete: Other (conf=0.85)
2026-01-30 04:31:50,421 | INFO | data_processing.app.graph.ingest_graph | Chunking + embedding doc_id=8351626d-da95-4094-bdfe-89f5eb2ff64e
2026-01-30 04:31:50,422 | INFO | data_processing.app.graph.ingest_graph | Prepared 5 chunks for embedding doc_id=8351626d-da95-4094-bdfe-89f5eb2ff64e
2026-01-30 04:31:56,666 | INFO | httpx | HTTP Request: POST http://10.0.1.100:11434/api/embed "HTTP/1.1 200 OK"
2026-01-30 04:31:56,669 | INFO | httpx | HTTP Request: GET http://10.0.1.101:6333/collections "HTTP/1.1 200 OK"
2026-01-30 04:31:56,669 | INFO | data_processing.app.graph.ingest_graph | Ensured Qdrant collection doc_id=8351626d-da95-4094-bdfe-89f5eb2ff64e vector_dim=768
2026-01-30 04:31:56,669 | INFO | data_processing.app.graph.ingest_graph | Qdrant upsert doc_id=8351626d-da95-4094-bdfe-89f5eb2ff64e batch=5 dim=768
2026-01-30 04:31:56,679 | INFO | httpx | HTTP Request: PUT http://10.0.1.101:6333/collections/docs_chunks/points?wait=true "HTTP/1.1 200 OK"
2026-01-30 04:31:56,683 | INFO | data_processing.app.graph.ingest_graph | Chunk embed upsert complete doc_id=8351626d-da95-4094-bdfe-89f5eb2ff64e chunks=5 dim=768
2026-01-30 04:31:56,692 | INFO | message_queue_listener | Processed OK
2026-01-30 05:44:14,544 | INFO | message_queue_listener | Processed OK job_id=7bf60365800c423f9c939b1304cc5e60 request_id=None -> exchange=app_exchange rk=data.pipeline.output.document_processing_default
2026-01-30 05:44:14,545 | ERROR | pika.adapters.utils.io_services_utils | _AsyncBaseTransport._consume() failed, aborting connection: error=ConnectionResetError(104, 'Connection reset by peer'); sock=<socket.socket fd=16, family=2, type=1, proto=6, laddr=('10.0.0.4', 60970)>; Caller's stack:
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/pika/adapters/utils/io_services_utils.py", line 1047, in _on_socket_readable
    self._consume()
  File "/usr/local/lib/python3.12/site-packages/pika/adapters/utils/io_services_utils.py", line 791, in _consume
    data = self._sigint_safe_recv(self._sock, self._MAX_RECV_BYTES)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/pika/adapters/utils/io_services_utils.py", line 79, in retry_sigint_wrap
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/pika/adapters/utils/io_services_utils.py", line 846, in _sigint_safe_recv
    return sock.recv(max_bytes)
           ^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
2026-01-30 05:44:14,546 | WARNING | data_processing.app.llm.client | Retrying connection in 5 seconds
2026-01-30 05:44:17,551 | INFO | pika.adapters.utils.connection_workflow | Pika version 1.3.2 connecting to ('10.0.1.50', 5672)

